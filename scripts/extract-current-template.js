// Script para extraer la plantilla JSON actual del c√≥digo
const fs = require('fs');
const path = require('path');

function extractCurrentTemplate() {
  try {
    console.log('üìã Extrayendo plantilla JSON actual del c√≥digo...');
    
    // Esta es la plantilla actual tal como est√° en el c√≥digo
    const currentTemplate = {
      // ===== RESTRICCIONES DE CAMPOS (IMPORTANTE LEER) =====
      // Los siguientes campos tienen restricciones espec√≠ficas en la base de datos:
      // 
      // CAMPOS NUM√âRICOS CON RANGOS ESTRICTOS:
      // - nivel_credibilidad/credibilidad_score: 0-5 (decimal, precisi√≥n 0.1)
      // - ponderacion_impacto: 1-5 (entero)
      // - potencial_adaptacion: 1-3 (entero)
      // - dificultad_produccion: 1-5 (entero)
      // - factores_credibilidad (todos los subcampos): 1-5 (entero cada uno)
      //
      // CAMPOS ENUM (valores espec√≠ficos permitidos):
      // - fuente_relato: 'llamada_oyente' | 'historia_programa' | 'investigacion_propia'
      // - nivel_verificacion: 'sin_verificar' | 'testimonio_unico' | 'multiples_testigos' | 'evidencia_fisica' | 'investigacion_completa' | 'verificado_experto'
      // - duracion_impacto_emocional: 'leve' | 'moderado' | 'intenso' | 'traum√°tico'
      // - derechos_uso: 'dominio_publico' | 'uso_libre' | 'permiso_verbal' | 'contrato_firmado' | 'pendiente_autorizacion' | 'uso_restringido'
      // - estado_procesamiento: 'extraida' | 'en_adaptacion' | 'adaptada' | 'en_produccion' | 'producida' | 'publicada'
      //
      // TIPOS DE ARCHIVO MULTIMEDIA V√ÅLIDOS:
      // - tipo_archivo: 'audio_original' (para archivos de audio)
      // - tipo_archivo: 'imagen_portada' (para im√°genes principales)
      //
      // ===== IDENTIFICACI√ìN Y CONTROL =====
      codigo_unico: "BOGOTA_TEQUENDAMA_001",
      fecha_transcripcion: "2024-12-20",
      estado_procesamiento: "extraida",
      hash_similarity: "a4b7c9d2e5f8g1h4i7j0k3l6m9n2o5p8",
      palabras_clave_patron: ["hotel", "ascensores", "pasillos", "historico", "nocturno", "transparente"],
      
      // ===== INFORMACI√ìN B√ÅSICA =====
      titulo: "Fen√≥menos Inexplicables en el Hotel Tequendama",
      descripcion_corta: "Un hu√©sped reporta actividad paranormal en el ic√≥nico hotel de Bogot√°",
      descripcion_larga: "Durante su estad√≠a en el Hotel Tequendama, un turista experimenta fen√≥menos inexplicables que lo marcan de por vida.",
      testimonio_completo: "Yo me qued√© en el Hotel Tequendama en diciembre del a√±o pasado. Era mi primera vez en Bogot√° y quer√≠a quedarme en un lugar emblem√°tico. La primera noche todo normal, pero la segunda noche empezaron los ruidos extra√±os...",
      extracto_verbatim: "Los ascensores se mov√≠an solos, las luces se prend√≠an y apagaban, y jurar√≠a que alguien caminaba por los pasillos en la madrugada",
      historia_reescrita: "La noche bogotana envolv√≠a el Hotel Tequendama cuando Juan decidi√≥ salir de su habitaci√≥n. Lo que no sab√≠a era que no estaba solo en esos pasillos llenos de historia...",
      suceso_principal_resumen: "Actividad paranormal intensa en hotel hist√≥rico con m√∫ltiples fen√≥menos reportados por hu√©sped",
      protagonistas_descripcion: "Juan Carlos M., ingeniero de 35 a√±os en viaje de negocios",
      
      // ===== ARCHIVOS MULTIMEDIA COMPLETOS =====
      archivos_multimedia: [
        {
          tipo_archivo: "audio_original",  // REQUERIDO: Usar exactamente este valor
          nombre_archivo: "BOGOTA_TEQUENDAMA_001_original.mp3",
          ruta_absoluta: "https://res.cloudinary.com/tu-cuenta/video/upload/v1234567890/archivos-paranormales/historias/audio_ejemplo.mp3",  // REQUERIDO: URL completa de Cloudinary
          ruta_relativa: "audio/originales/BOGOTA_TEQUENDAMA_001_original.mp3",
          "tama√±o_bytes": 8388608,  // Nota: usar "tama√±o_bytes" con √±
          hash_archivo: "sha256:audio_hash_example",
          duracion_segundos: 480,
          formato: "mp3",
          bitrate: "192kbps",
          sample_rate: 44100,
          canales: 2,
          descripcion: "Testimonio original completo",
          version: 1,
          is_active: true
        },
        {
          tipo_archivo: "imagen_portada",  // REQUERIDO: Usar exactamente este valor
          nombre_archivo: "BOGOTA_TEQUENDAMA_001_portada.jpg",
          ruta_absoluta: "https://res.cloudinary.com/tu-cuenta/image/upload/v1234567890/archivos-paranormales/historias/portada_ejemplo.jpg",  // REQUERIDO: URL completa de Cloudinary
          ruta_relativa: "imagen/portadas/BOGOTA_TEQUENDAMA_001_portada.jpg",
          "tama√±o_bytes": 2097152,  // Nota: usar "tama√±o_bytes" con √±
          ancho_px: 1920,
          alto_px: 1080,
          descripcion: "Hotel Tequendama de noche con efectos paranormales",
          metadata_extra: {
            photographer: "AI Generated",
            style: "Hotel hist√≥rico nocturno",
            color_scheme: "Blue-black gradient",
            mood: "Misterioso"
          }
        }
      ],
      
      // ===== UBICACI√ìN COMPLETA =====
      ubicacion: {
        pais: "Colombia",
        codigo_pais: "CO",
        nivel1_nombre: "Cundinamarca",
        nivel1_codigo: "CUN", 
        nivel2_nombre: "Bogot√°",
        nivel2_codigo: "BOG",
        nivel3_nombre: "La Candelaria",
        nivel4_nombre: "Centro Hist√≥rico",
        latitud: 4.6097,
        longitud: -74.0817,
        precision_metros: 10,
        descripcion_lugar: "Hotel emblem√°tico del centro de Bogot√°",
        lugar_especifico: "Hotel Tequendama",
        tipo_lugar: "hotel",
        zona_horaria: "America/Bogota",
        altitud_metros: 2640,
        actividad_paranormal_reportada: true,
        numero_historias_reportadas: 3,
        primera_actividad_reportada: "1985-03-15",
        ultima_actividad_reportada: "2024-12-15",
        verificada: true,
        fuente_verificacion: "Google Maps + confirmaci√≥n hotel"
      },
      
      // ===== CLASIFICACI√ìN Y AN√ÅLISIS =====
      fuente_relato: "llamada_oyente",
      genero_principal: "paranormal",
      epoca_historica: "Contempor√°nea",
      nivel_credibilidad: 4.5, // Rango: 0-5 (decimal) ‚úÖ CORRECTO
      nivel_impacto: 4,        // Rango: 1-5 (entero) ‚úÖ CORRECTO
      ponderacion_impacto: 5,  // Rango: 1-5 (entero) ‚úÖ CORRECTO
      potencial_adaptacion: 3, // Rango: 1-3 (entero) ‚úÖ CORRECTO
      nivel_verificacion: "multiples_testigos",
      longitud_extracto_palabras: 156,
      
      // ===== FACTORES DE CREDIBILIDAD =====
      // Todos los valores en rango 1-5 ‚úÖ CORRECTO
      factores_credibilidad: {
        multiples_testigos: 4,      // 1-5: N√∫mero de testigos
        evidencia_fisica: 2,        // 1-5: Nivel de evidencia f√≠sica
        consistencia_relatos: 4,    // 1-5: Consistencia entre testimonios
        ubicacion_verificable: 5,   // 1-5: Verificabilidad del lugar
        contexto_historico: 4,      // 1-5: Contexto hist√≥rico del lugar
        sobriedad_testigo: 5,       // 1-5: Estado de sobriedad del testigo
        conocimiento_previo: 2,     // 1-5: Conocimiento previo de lo paranormal
        estado_emocional: 4         // 1-5: Estabilidad emocional del testigo
      },
      banderas_rojas: [],
      
      // ===== FECHAS Y TEMPORALIDAD =====
      fecha_sucesos: "2024-12-15",
      fecha_evento_inicio: "2024-12-15",
      fecha_evento_fin: "2024-12-17",
      hora_evento: "02:30:00",
      evento_recurrente: true,
      
      // ===== PRODUCCI√ìN =====
      dificultad_produccion: 3,      // Rango: 1-5 (entero) - Dificultad de producci√≥n ‚úÖ CORRECTO
      tiempo_produccion_estimado: 300, // En minutos - Tiempo estimado de producci√≥n
      presupuesto_estimado: 150.00,   // En pesos colombianos - Presupuesto estimado
      
      // ===== CONTENIDO Y ADVERTENCIAS =====
      contenido_sensible: true,
      advertencias: ["actividad_poltergeist", "contenido_perturbador", "apariciones_nocturnas"],
      edad_minima_recomendada: 16,
      duracion_impacto_emocional: "moderado",  // VALORES V√ÅLIDOS: 'leve' | 'moderado' | 'intenso' | 'traum√°tico' ‚úÖ CORRECTO
      
      // ===== TESTIGOS =====
      testigo_principal: {
        pseudonimo: "Juan Carlos M.",
        edad_aprox: 35,
        ocupacion: "Ingeniero",
        relacion_evento: "Hu√©sped del hotel durante los eventos",
        presencial: true,
        credibilidad_estimada: 4,
        factores_credibilidad: {
          estado_mental: 5,
          sobriedad: 5,
          consistencia: 4,
          motivaciones_secundarias: 1
        },
        antecedentes_paranormales: false,
        contacto_disponible: false,
        notas_testigo: "Persona racional, sin historial de experiencias paranormales previas"
      },
      
      testigos_secundarios: [
        {
          pseudonimo: "Personal de Limpieza",
          tipo_testigo: "secundario",
          edad_aprox: 45,
          ocupacion: "Trabajador del hotel",
          relacion_evento: "Reporta actividad similar en el mismo piso",
          presencial: true,
          credibilidad_estimada: 3,
          notas: "Confirma algunos aspectos del testimonio principal"
        }
      ],
      
      // ===== DERECHOS =====
      derechos_uso: "permiso_verbal",         // ENUM v√°lido ‚úÖ CORRECTO
      autorizacion_comercial: true,
      autorizacion_adaptacion: true,
      restricciones_uso: "Ninguna restricci√≥n espec√≠fica",
      contacto_derechos: "admin@archivosparanormales.com",
      
      // ===== CONTROL =====
      publicar_inmediatamente: true
    };

    // Guardar plantilla actual
    const currentPath = path.join(process.cwd(), 'plantilla_actual_descargable.json');
    fs.writeFileSync(currentPath, JSON.stringify(currentTemplate, null, 2));
    
    console.log('\nüìÅ ARCHIVOS GENERADOS:');
    console.log('======================');
    console.log(`‚úÖ Plantilla actual: ${currentPath}`);
    
    // Verificar valores cr√≠ticos
    console.log('\nüîç VERIFICACI√ìN DE VALORES CR√çTICOS:');
    console.log('====================================');
    console.log(`‚úÖ nivel_credibilidad: ${currentTemplate.nivel_credibilidad} (debe ser 0-5)`);
    console.log(`‚úÖ ponderacion_impacto: ${currentTemplate.ponderacion_impacto} (debe ser 1-5)`);  
    console.log(`‚úÖ potencial_adaptacion: ${currentTemplate.potencial_adaptacion} (debe ser 1-3)`);
    console.log(`‚úÖ dificultad_produccion: ${currentTemplate.dificultad_produccion} (debe ser 1-5)`);
    console.log(`‚úÖ duracion_impacto_emocional: "${currentTemplate.duracion_impacto_emocional}" (debe ser enum v√°lido)`);
    console.log(`‚úÖ derechos_uso: "${currentTemplate.derechos_uso}" (debe ser enum v√°lido)`);
    
    // Verificar archivos multimedia
    console.log('\nüé¨ ARCHIVOS MULTIMEDIA:');
    console.log('======================');
    currentTemplate.archivos_multimedia.forEach((archivo, index) => {
      console.log(`üìÅ Archivo ${index + 1}:`);
      console.log(`   tipo_archivo: "${archivo.tipo_archivo}" (debe ser 'audio_original' o 'imagen_portada')`);
      console.log(`   ruta_absoluta: ${archivo.ruta_absoluta ? 'PRESENTE' : 'FALTANTE'} (debe usar ruta_absoluta, no url_cloudinary)`);
    });

    console.log('\nüéØ ESTA ES LA PLANTILLA QUE SE DESCARGA ACTUALMENTE');
    console.log('Comp√°rala con la que descargas desde el panel admin');

  } catch (error) {
    console.error('üí• Error extrayendo plantilla:', error);
  }
}

extractCurrentTemplate();